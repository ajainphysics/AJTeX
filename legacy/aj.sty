%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Article/Book Styling Package (aj.sty)              %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Author: Akash Jain                                 %%%
%%% Email: ajainphysx@gmail.com                        %%%
%%% Last Updated: Feb 11, 2016                         %%%
%%% Description: This package contains style for       %%%
%%%  article and book document classes.                %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\NeedsTeXFormat{LaTeX2e}[1995/12/01]
\ProvidesPackage{aj}[2016/02/11 Article Styling Package by Akash Jain]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Class options %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\gclass}{article}
\newcommand{\gsides}{oneside}
\newcommand{\gifdraft}{0}
\newcommand{\gnoauthor}{0}
\newcommand{\gnotitlepage}{0}
\newcommand{\gheadertitle}{0}
\newcommand{\gshowcomments}{0}
\newcommand{\gnolistofcontents}{0}
\newcommand{\gshowpreprintnumbers}{0}

\RequirePackage{kvoptions}

\SetupKeyvalOptions{family=aj-article,prefix=aj-article@}
\DeclareStringOption[1]{version}[latest]

% document class
\DeclareVoidOption{book}{\renewcommand{\gclass}{book}}
\DeclareVoidOption{article}{\renewcommand{\gclass}{article}}
\DeclareVoidOption{cv}{\renewcommand{\gclass}{cv}}

% oneside/twoside
\DeclareVoidOption{oneside}{\renewcommand{\gsides}{oneside}}
\DeclareVoidOption{twoside}{\renewcommand{\gsides}{twoside}}

\DeclareVoidOption{headertitle}{\renewcommand{\gheadertitle}{1}}

% draft
\DeclareVoidOption{isdraft}{\renewcommand{\gifdraft}{1}}

% no author
\DeclareVoidOption{noauthor}{\renewcommand{\gnoauthor}{1}}

% no title page
\DeclareVoidOption{notitlepage}{\renewcommand{\gnotitlepage}{1}}

% no list of contents
\DeclareVoidOption{nolistofcontents}{\renewcommand{\gnolistofcontents}{1}}

% show comments
\DeclareVoidOption{showcomments}{\renewcommand{\gshowcomments}{1}}

% show preprint numbers
\DeclareVoidOption{showpreprintnumbers}{\renewcommand{\gshowpreprintnumbers}{1}}

\ProcessKeyvalOptions*

\RequirePackage{aj-pkgs}
\RequirePackage{aj-defs}

%%% PAGE DIMENSIONS
\RequirePackage{geometry} % to change the page dimensions
\geometry{a4paper} % or letterpaper (US) or a5paper or....
\geometry{margin=1in} % for example, change the margins to 2 inches all round

\hypersetup{
  colorlinks=true,	% false: boxed links; true: colored links
  linkcolor=blue,	% color of internal links
  citecolor=red,	% color of links to bibliography
  filecolor=blue,	% color of file links
  urlcolor=blue		% color of external links
}
        
\RequirePackage{pgffor}
\RequirePackage[numbers,sort&compress]{natbib}
\RequirePackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather
                                % than an indent

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Latex options modifications %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setcounter{secnumdepth}{5} % Depth of sections
\setcounter{tocdepth}{3}

\definecolor{gray75}{gray}{0.75}

\makeatletter
\newcommand*\shortyear[1]{\expandafter\@gobbletwo\number\numexpr#1\relax}
\makeatother
\newdateformat{smalldate}{\THEDAY~\shortmonthname[\THEMONTH]'\shortyear{\THEYEAR}}
\IfStrEq{\gifdraft}{1}{
  \newcommand{\gModDate}{{\smalldate \today}, \currenttime}
  \newcommand{\gModDateLong}{\today, \currenttime}
}{}

\usdate

% footnotes
\makeatletter
\def\@xfootnote[#1]{%
  \protected@xdef\@thefnmark{#1}
  \@footnotemark\@footnotetext
}
\makeatother

\newenvironment{symbolfootnotes}
{
  \par\edef\savedfootnotenumber{\number\value{footnote}}
  \renewcommand{\thefootnote}{\fnsymbol{footnote}}
  \setcounter{footnote}{0}
}
{\par\setcounter{footnote}{\savedfootnotenumber}}

% headers, footers and page style
\setlength{\headheight}{13.6pt}
\newcommand{\headrulecolor}[1]{\patchcmd{\headrule}{\hrule}{\color{#1}\hrule}{}{}}
\newcommand{\footrulecolor}[1]{\patchcmd{\footrule}{\hrule}{\color{#1}\hrule}{}{}}
\headrulecolor{gray75}
\fancypagestyle{plain}{
  \fancyhf[FC]{\footnotesize -- \thepage \ --}
  \fancyhf[FL,FR,HL,HC,HR]{}
  \renewcommand{\headrulewidth}{0pt}
}
\pagestyle{fancy}

\newcounter{defcounter}

\makeatletter
\newenvironment{comments}
{%
  \IfStrEq{\gshowcomments}{0}{\expandafter\comment}{
    \begin{shaded}
      \global\chardef\dc@currentequation=\value{equation}%
      \let\c@equation\c@defcounter
      \renewcommand{\theequation}{\%.\arabic{equation}}%
      % comment the following line if you don't use hyperref
      \renewcommand{\theHequation}{\%.\arabic{equation}}%
      \textbf{Comments:}%
    }%
}
{%
  \IfStrEq{\gshowcomments}{0}{\expandafter\endcomment}{
  \end{shaded}
  \setcounter{equation}{\dc@currentequation}
}%
}
\makeatother

% \makeatletter
% \newenvironment{defn}
%  {\global\chardef\dc@currentequation=\value{equation}%
%   \let\c@equation\c@defcounter
%   \renewcommand{\theequation}{D\arabic{equation}}%
%   % comment the following line if you don't use hyperref
%   \renewcommand{\theHequation}{D\arabic{equation}}%
%   \defninn}
%  {\enddefninn
%   \setcounter{equation}{\dc@currentequation}}
% \makeatother


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% title page and authors %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcounter{authors}
\renewcommand\author[3][]{%
  \stepcounter{authors}%
  \csdef{author-affil\theauthors}{#1}%
  \csdef{author-name\theauthors}{#2}%
  \csdef{author-email\theauthors}{#3}%
}
\newcommand\getauthor[2]{\csuse{author-#2#1}}

\newcounter{affils}
\newcommand{\affiliation}[2][]{
  \stepcounter{affils}
  \csdef{affil-id\theaffils}{#1}
  \csdef{affil-name\theaffils}{#2}
}

\newcommand{\gAuthor}{\getauthor{1}{name}}
\newcommand{\gEmail}{\getauthor{1}{email}}

\renewcommand\title[1]{%
  \csdef{setgTitle}{#1}%
}
\newcommand{\gTitle}{\csuse{setgTitle}}

\csdef{setgAbstract}{}
\csdef{setgAbstract-switch}{0}
\providecommand\abstract[1]{}
\renewcommand\abstract[1]{%
  \csdef{setgAbstract}{#1}%
  \csdef{setgAbstract-switch}{1}%
}
\newcommand{\gAbstract}{\csuse{setgAbstract}}
\newcommand{\gAbstractSwitch}{\csuse{setgAbstract-switch}}


\csdef{setgPreprint}{}
\csdef{setgPreprint-switch}{0}
\providecommand\preprint[1]{}
\renewcommand\preprint[1]{%
  \csdef{setgPreprint}{#1}%
  \csdef{setgPreprint-switch}{1}%
}
\newcommand{\gPreprint}{\csuse{setgPreprint}}
\newcommand{\gPreprintSwitch}{\csuse{setgPreprint-switch}}

\renewcommand{\maketitle}{
  \thispagestyle{empty}

  \ \\

  \IfStrEq{\gshowpreprintnumbers}{1}{
    \IfStrEq{\gPreprintSwitch}{}{}{
      \vspace{-6em}
      \begin{flushright}
        {\raggedleft \gPreprint}
      \end{flushright}
      \vspace{4em}
    }
  }{}
  
  % title
  {\raggedright \sffamily \huge \bfseries \gTitle}
  \vspace{2em} 
  \hrule height 1.5pt
  
  % authors and affiliation
  \IfStrEq{\gnoauthor}{0}{ 
    \vspace{2em}
    \begin{symbolfootnotes}
      \newcommand{\theauthorsm}{\numexpr \theauthors - 1 \relax}
      \foreach \index in {1, ..., \theauthors} {
        \raggedright \sffamily
        \textbf{\getauthor{\index}{name}{\ifnum
            \index=\theauthors{}\else{\ifnum\index=\theauthorsm{}\else,\fi}\fi}}\footnote{Email:
          \getauthor{\index}{email}}\textsuperscript{\getauthor{\index}{affil}}
        \ifnum\index=\theauthorsm\textbf{and}\fi
      }\par
    \end{symbolfootnotes}
    \foreach \index in {1, ..., \theaffils}{ \textsuperscript{\csuse{affil-id\index}}\csuse{affil-name\index} \par}
  }{}
  
  % abstract
  \IfStrEq{\gAbstractSwitch}{1}{ 
    \vspace{2em}
    \setlength{\leftskip}{0.5cm}
    \setlength{\rightskip}{0.5cm}
    {\textsc{Abstract:} \gAbstract \par}
    \setlength{\leftskip}{0pt}
    \setlength{\rightskip}{0pt}
  }{}
  
  % date
  \vspace{1em}		
  \IfStrEq{\gifdraft}{1}{\textsc{Drafted}: \gModDateLong}{\textsc{Dated}: \today} 		
  
  % page-break
  \IfStrEq{\gnotitlepage}{1}{}{\newpage}
  
  % table of contents
  \IfStrEq{\gnolistofcontents}{1}{}{
    \tableofcontents
  }
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% theorem styles %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% definition
\theoremstyle{plain}
\theoremheaderfont{\hspace{-.3cm}\normalfont\bfseries}
\theorembodyfont{\upshape}
\theoremsymbol{}
\theoremseparator{.}
\theoremindent0.3cm
\theorempreskip{0.5cm}
\theorempostskip{0.3cm}
\IfStrEq{\gclass}{book}{\newtheorem{definition}{Definition}[chapter]}{\newtheorem{definition}{Definition}[section]}

% theorem
\theoremclass{definition}
\IfStrEq{\gclass}{book}{\newtheorem{theorem}{Theorem}[chapter]}{\newtheorem{theorem}{Theorem}[section]}

% example
\theoremclass{definition}
\IfStrEq{\gclass}{book}{\newtheorem{example}{Example}[chapter]}{\newtheorem{example}{Example}[section]}

% lemma
\theoremclass{definition}
\newtheorem{lemma}[theorem]{Lemma}

% proposition
\theoremclass{definition}
\newtheorem{proposition}[theorem]{Proposition}

% corollary
\theoremclass{definition}
\theoremindent0.5cm
\theorempreskip{0.2cm}
\newtheorem{corollary}{Corollary}[theorem]

% remark
\theoremclass{definition}
\theoremstyle{nonumberplain}
\theoremindent0.5cm
\theorempreskip{0.2cm}
\newtheorem{remark}{Remark}

% remark
\theoremclass{remark}
\newtheorem{phyremark}{Physicists' Remark}

% proof
\theoremstyle{nonumberplain}
\theoremheaderfont{\hspace{-.3cm}\sc}
\theorembodyfont{\upshape}
\theoremsymbol{$\square$}
\theoremseparator{:}
\theoremindent0.5cm
\theorempreskip{0.2cm}
\theorempostskip{0.3cm}
\newtheorem{proof}{Proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% article class commands %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\IfStrEq{\gclass}{article}{

  \renewcommand{\baselinestretch}{1.2}	% line space between different elements
  
\numberwithin{equation}{section}	% equations numbers are looped in sections

% title formatting
\titleformat{\section}[hang]{\Large\bfseries}{\thesection\hspace{10pt}\textcolor{gray75}{|}\hspace{10pt}}{0pt}{\Large\bfseries}[\vspace{1ex}\titlerule]

% header formatting
\IfStrEq{\gsides}{twoside}{
  \fancyhf[HLE]{\footnotesize \hspace{1px} \thepage \textcolor{gray75}{\bfseries \hspace{2px} |}}
  \fancyhf[HLO]{\footnotesize \hspace{1px} \nouppercase \leftmark \IfStrEq{\gifdraft}{1}{\ -- Draft (\gModDate)}{}}
  \fancyhf[HC]{}
  \fancyhf[HRE]{\footnotesize \nouppercase \rightmark \IfStrEq{\gifdraft}{1}{\ -- Draft (\gModDate)}{} \hspace{1px}}
  \fancyhf[HRO]{\footnotesize \textcolor{gray75}{\bfseries | \hspace{2px}} \thepage \hspace{1px}}
  \fancyhf[FL]{}
  \fancyhf[FC]{}
  \fancyhf[FR]{}
}
{
  \fancyhf[HL]{\footnotesize \hspace{1px} \thepage \textcolor{gray75}{\bfseries \hspace{2px} |}}
  \fancyhf[HC]{}
  \fancyhf[HR]{\footnotesize \IfStrEq{\gheadertitle}{1}{\gTitle}{\nouppercase \leftmark}  \IfStrEq{\gifdraft}{1}{\ -- Draft (\gModDate)}{} \hspace{1px}}
  \fancyhf[FL]{}
  \fancyhf[FC]{}
  \fancyhf[FR]{}
}

}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% book class commands %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\IfStrEq{\gclass}{book}{

  \renewcommand{\baselinestretch}{1.2}	% line space between different elements
  
  \numberwithin{equation}{chapter}	% equations numbers are looped in chapters

% title formatting
\titlespacing*{\part}{0pt}{0pt}{20pt}
\titlespacing*{\chapter}{0pt}{0pt}{20pt}

\titleformat{\part}[display]{\LARGE\centering}{\textbf{PART - \thepart}}{1pt}{\LARGE\bfseries}[\vspace{2ex}\titlerule]
\titleformat{\chapter}[hang]{\LARGE\bfseries}{\thechapter\hspace{20pt}\textcolor{gray75}{|}\hspace{20pt}}{0pt}{\LARGE\bfseries}[\vspace{2ex}\titlerule]
\titleformat{\section}[hang]{\Large\bfseries}{\thesection\hspace{10pt}\textcolor{gray75}{|}\hspace{10pt}}{0pt}{\Large\bfseries}[\vspace{1ex}\titlerule]

% header formatting
\IfStrEq{\gsides}{twoside}{
  \fancyhf[HLE]{\footnotesize \hspace{1px} \thepage \textcolor{gray75}{\bfseries \hspace{2px} |}}
  \fancyhf[HLO]{\footnotesize \hspace{1px} \nouppercase \leftmark \IfStrEq{\gifdraft}{1}{\ -- Draft (\gModDate)}{}}
  \fancyhf[HC]{}
  \fancyhf[HRE]{\footnotesize \nouppercase \rightmark \IfStrEq{\gifdraft}{1}{\ -- Draft (\gModDate)}{} \hspace{1px}}
  \fancyhf[HRO]{\footnotesize \textcolor{gray75}{\bfseries | \hspace{2px}} \thepage \hspace{1px}}
  \fancyhf[FL]{}
  \fancyhf[FC]{}
  \fancyhf[FR]{}
}
{
  \fancyhf[HL]{\footnotesize \hspace{1px} \thepage \textcolor{gray75}{\bfseries \hspace{2px} |}}
  \fancyhf[HC]{}
  \fancyhf[HR]{\footnotesize \nouppercase \leftmark \IfStrEq{\gifdraft}{1}{\ -- Draft (\gModDate)}{} \hspace{1px}}
  \fancyhf[FL]{}
  \fancyhf[FC]{}
  \fancyhf[FR]{}
}

}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% cv class commands %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\IfStrEq{\gclass}{cv}{

  \renewcommand{\baselinestretch}{1}	% line space between different elements
  
  \numberwithin{equation}{section}	% equations numbers are looped in sections
  
  % title formatting
  \titleformat{\section}[hang]{\Large\bfseries}{}{0pt}{\Large\bfseries}[\vspace{1ex}\titlerule]
  \renewcommand{\subsection}[1]{\subsubsection*{$\blacktriangleright$ #1}}
  
  % header formatting
  \fancyhf[HL]{\footnotesize \hspace{1px} \thepage \textcolor{gray75}{\bfseries \hspace{2px} |}}
  \fancyhf[HC]{}
  \fancyhf[HR]{\footnotesize \IfStrEq{\gheadertitle}{1}{\gTitle}{\nouppercase \leftmark}  \IfStrEq{\gifdraft}{1}{\ -- Draft (\gModDate)}{} \hspace{1px}}
  \fancyhf[FL]{}
  \fancyhf[FC]{}
  \fancyhf[FR]{}
  
}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% bibliography styling %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand*{\bibfont}{\small}

\newcommand{\makereferences}{%
  \bibliographystyle{utcaps.bst}
  \bibliography{aj-bib}
}

%% 
%% End of file `ghosteens.cls'.