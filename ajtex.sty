%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Article/Book Styling Package (ajTeX)               %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Author: Akash Jain                                 %%%
%%% Email: ajainphysx@gmail.com                        %%%
%%% Description: This package contains style for       %%%
%%% article and book document classes.                 %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

\NeedsTeXFormat{LaTeX2e}[1995/12/01]
\ProvidesPackage{ajtex}[2017/02/16 Article/Book Styling Package by Akash Jain]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Class commands %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

\RequirePackage{kvoptions}

\SetupKeyvalOptions{family=ajtex,prefix=ajtex@}
\DeclareStringOption[1]{version}[latest]

%%% No styling
\newcommand{\gstyling}{1}
\DeclareVoidOption{nostyling}{\renewcommand{\gstyling}{0}}

% put title in headers instead of section
\newcommand{\gheadertitle}{0}
\DeclareVoidOption{headertitle}{\renewcommand{\gheadertitle}{1}}

% draft
\newcommand{\gifdraft}{0}
\DeclareVoidOption{draft}{\renewcommand{\gifdraft}{1}}

% no title page
\newcommand{\gnotitlepage}{0}
\DeclareVoidOption{notitlepage}{\renewcommand{\gnotitlepage}{1}}

% no list of contents
\newcommand{\gnolistofcontents}{0}
\DeclareVoidOption{nolistofcontents}{\renewcommand{\gnolistofcontents}{1}}

% show comments
\newcommand{\gshowcomments}{0}
\DeclareVoidOption{showcomments}{\renewcommand{\gshowcomments}{1}}

% use US Letter layout
\newcommand{\gafourpaper}{0}
\DeclareVoidOption{a4paper}{\renewcommand{\gafourpaper}{1}}

% basic start
\newcommand{\gbasic}{0}
\DeclareVoidOption{basic}{\renewcommand{\gbasic}{1}}

%%% Document Class
\newcommand{\gclass}{article}
\@ifclassloaded{book}{\renewcommand{\gclass}{book}}{}
\DeclareVoidOption{cv}{\renewcommand{\gclass}{cv}}

\ProcessKeyvalOptions*

\RequirePackage[utf8]{inputenc} % To support utf8 characters
\RequirePackage[T1]{fontenc} % T1 font encoding
\RequirePackage{microtype}
\RequirePackage[pangram]{blindtext} % Fake placeholder text

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Logical packages %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

\RequirePackage{xstring} % For string conditionals
\RequirePackage{etoolbox} % A toolbox from programming
\RequirePackage{pgffor} % For loop
\RequirePackage{calc,fp} % For calculations

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Math Packages %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage[mathscr]{euscript}

\RequirePackage{mathtools}
\RequirePackage{centernot} % provides a centered \not on a symbol
\RequirePackage{cancel} % cancel a term to a value
\RequirePackage{amssymb} % mathematical symbols
\RequirePackage{bm}
\RequirePackage{relsize}
\RequirePackage{tensor}  % Package for tensor indices

\RequirePackage{accents}  % Package for allowing accents over math symbols

\RequirePackage[Symbolsmallscale]{upgreek}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Lists %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{paralist} % provides lists like enumerate and itemize
\RequirePackage{enumitem} % customization for lists

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Graphics %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \RequirePackage{tikz}
\RequirePackage{graphicx} % support the \includegraphics command and options

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Tables and floats %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{float}
\RequirePackage{wrapfig}
\RequirePackage[font=small,labelfont=bf]{caption}
\RequirePackage{subcaption}

\RequirePackage{array} % for programmable tables
\RequirePackage{booktabs}	% for much better looking tables
\RequirePackage{tabularx} 	% for flexible tables
\RequirePackage{multirow}	% multiple rows in tables

%%% TEXT HIGHLIGHTING %%%
\RequirePackage{soul} % adds highlighting

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% ajTeX Style File %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\IfStrEq{\gstyling}{1}{
   
  %%% Font %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
  
  \RequirePackage{helvet} % helvet font package
  
  %%% Date and time %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  \RequirePackage{datetime}
  \newcommand*\shortyear[1]{\expandafter\@gobbletwo\number\numexpr#1\relax}
  \newdateformat{smalldate}{\THEDAY~\shortmonthname[\THEMONTH]'\shortyear{\THEYEAR}}
  \IfStrEq{\gifdraft}{1}{
    \newcommand{\gModDate}{{\smalldate \today}, \currenttime}
    \newcommand{\gModDateLong}{\today~at~\currenttime}
  }{}
  \usdate
     
  %%% Page layout and formatting %%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  %%% PAGE DIMENSIONS %%%
  \RequirePackage{geometry} % to change the page dimensions
  \IfStrEq{\gafourpaper}{1}{\geometry{a4paper}}{\geometry{letterpaper}} % paper layout
  \geometry{margin=1in,tmargin=1.3in}

  %%% TEXT SPACING %%%
  \RequirePackage[parfill]{parskip} % begin paragraphs with an empty line rather than an indent
  
  \renewcommand{\baselinestretch}{1.2} % line space between different elements
  \IfStrEq{\gclass}{cv}{\renewcommand{\baselinestretch}{1}}{}

  %%% TEXT HIGHLIGHTING %%%
  \RequirePackage{soul} % adds highlighting

  %%% TEXT COLORS %%%
  \RequirePackage{xcolor} % To use colors

  %%% HYPERREF %%%
  \@ifpackageloaded{hyperref}{}{\RequirePackage{hyperref}} % for hyper links
  \hypersetup{ colorlinks=true, % false: boxed links; true: colored links
    linkcolor=blue, % color of internal links
    citecolor=red, % color of links to bibliography
    filecolor=blue, % color of file links
    urlcolor=blue % color of external links
  }

  %%% Title and headings %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \setcounter{secnumdepth}{5} % Depth of sections

  \RequirePackage{titlesec} % for changing title styles

  \IfStrEq{\gclass}{article}{
    \titleformat{\section}[hang]{\Large\bfseries}{\thesection \hspace{10pt}
      \textcolor{gray75}{$\vert$} \hspace{10pt}}{0pt}{\Large\bfseries}[\vspace{1ex}\titlerule] 
  }{}

  \IfStrEq{\gclass}{book}{
    \titlespacing*{\part}{0pt}{0pt}{20pt} \titlespacing*{\chapter}{0pt}{0pt}{20pt}
  
    \titleformat{\part}[display]{\LARGE\centering}{\textbf{PART -
        \thepart}}{1pt}{\LARGE\bfseries}[\vspace{2ex}\titlerule]
    \titleformat{\chapter}[hang]{\LARGE\bfseries}{\thechapter \hspace{20pt}
      \textcolor{gray75}{$\vert$} \hspace{20pt}}{0pt}{\LARGE\bfseries}[\vspace{2ex}\titlerule]
    \titleformat{\section}[hang]{\Large\bfseries}{\thesection \hspace{10pt}
      \textcolor{gray75}{$\vert$} \hspace{10pt}}{0pt}{\Large\bfseries}[\vspace{1ex}\titlerule]
  }{}

  \IfStrEq{\gclass}{cv}{
    % title formatting
    \titleformat{\section}[hang]{\Large\bfseries}{}{0pt}{\Large\bfseries}[\vspace{1ex}\titlerule]
    \renewcommand{\subsection}[1]{\subsubsection*{$\blacktriangleright$ #1}}
  }{}

  %%% Headers and footers %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \RequirePackage{fancyhdr} % This should be set AFTER setting up the page geometry

  \setlength{\headheight}{13.6pt}
  \newcommand{\headrulecolor}[1]{\patchcmd{\headrule}{\hrule}{\color{#1}\hrule}{}{}}
  \newcommand{\footrulecolor}[1]{\patchcmd{\footrule}{\hrule}{\color{#1}\hrule}{}{}}

  \definecolor{gray75}{gray}{0.75} \headrulecolor{gray75} \fancypagestyle{plain}{
    \fancyhf[FC]{\footnotesize -- \thepage \ --}
    \fancyhf[FL,FR,HL,HC,HR]{}
    \renewcommand{\headrulewidth}{0pt}
  }
  \pagestyle{fancy}
  
  \fancyhf[HLO]{\footnotesize \hspace{1px}
    \IfStrEq{\gheadertitle}{1}{\gTitle}{\nouppercase \rightmark}
    \IfStrEq{\gifdraft}{1}{\ -- Draft (\gModDate)}{}}
  \fancyhf[HRO]{\footnotesize \textcolor{gray75}{\bfseries
      $\vert$ \hspace{2px}} \thepage \hspace{1px}\ }
  
  \fancyhf[HLE]{\footnotesize \hspace{1px} \thepage
    \textcolor{gray75}{\bfseries \hspace{2px} $\vert$}}
  \fancyhf[HRE]{\footnotesize \nouppercase \leftmark
    \IfStrEq{\gifdraft}{1}{\ -- Draft (\gModDate)}{} \hspace{1px}}
  
  \fancyhf[FL,FC,FR,HC]{}

  %%% Table of contents %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \setcounter{tocdepth}{2}
  \RequirePackage[titles]{tocloft} % Alter the style of the Table of Contents
  \renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
  \renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!

  % \RequirePackage{titletoc} % for mini TOC

  %%% Footnotes %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  % footnotes
  \def\@xfootnote[#1]{
    \protected@xdef\@thefnmark{#1} \@footnotemark\@footnotetext
  }
  \def\blfootnote{\gdef\@thefnmark{}\@footnotetext}

  \newenvironment{symbolfootnotes} {
    \par\edef\savedfootnotenumber{\number\value{footnote}}
    \renewcommand{\thefootnote}{\fnsymbol{footnote}}
    \setcounter{footnote}{0}
  }
  {
    \par\setcounter{footnote}{\savedfootnotenumber}
  }
 
  %%% Title page and authors %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  \newcounter{authors}
  \renewcommand\author[2][]{%
    \stepcounter{authors}%
    \csdef{author-affil\theauthors}{#1}%
    \csdef{author-name\theauthors}{#2}%
  }
  \csdef{author-email-switch}{0}
  \newcommand\email[1]{
    \csdef{author-email-switch}{1}%
    \csdef{author-email\theauthors}{#1}%
  }
  \newcommand\note[1]{
    \csdef{author-note\theauthors}{#1}%
  }
  \newcommand\getauthor[2]{\csuse{author-#2#1}}

  \newcounter{affils}
  \newcommand{\affiliation}[2][]{ \stepcounter{affils}
    \csdef{affil-id\theaffils}{#1}
    \csdef{affil-name\theaffils}{#2}
  }

  \newcommand{\gAuthor}{\getauthor{1}{name}} \newcommand{\gEmail}{\getauthor{1}{email}}

  \renewcommand\title[1]{%
    \csdef{setgTitle}{#1}%
  } \newcommand{\gTitle}{\csuse{setgTitle}}

  \csdef{setgAbstract}{} \csdef{setgAbstract-switch}{0} \providecommand\abstract[1]{}
  \renewcommand\abstract[1]{%
    \csdef{setgAbstract}{#1}%
    \csdef{setgAbstract-switch}{1}%
  } \newcommand{\gAbstract}{\csuse{setgAbstract}}
  \newcommand{\gAbstractSwitch}{\csuse{setgAbstract-switch}}


  \csdef{setgPreprint}{}
  \csdef{setgPreprint-switch}{0}
  \providecommand\preprint[1]{}
  \renewcommand\preprint[1]{%
    \csdef{setgPreprint}{#1}%
    \csdef{setgPreprint-switch}{1}%
  } \newcommand{\gPreprint}{\csuse{setgPreprint}}
  \newcommand{\gPreprintSwitch}{\csuse{setgPreprint-switch}}

  \RequirePackage[table,figure,page]{totalcount}

  \renewcommand{\maketitle}{
    \thispagestyle{empty}
    
    \IfStrEq{\gPreprintSwitch}{0}{}{
      \ \\
      \vspace{-6em}
      \begin{flushright}
        {\raggedleft \gPreprint}
      \end{flushright}
      \vspace{6em}
      \IfStrEq{\gnotitlepage}{1}{\vspace{-2em}}{}
      \IfStrEq{\gbasic}{1}{\vspace{-2em}}{}
    }

    
    \if\gbasic0
    {\raggedright \bfseries \huge \gTitle \par}
    \else
    {\raggedright \bfseries \LARGE \gTitle \par}
    \fi
    
    \vspace{2em}
    \hrule height 1.5pt
  
    % authors and affiliation
    \IfStrEq{\theauthors}{0}{}{
      \vspace{2em}
      \begin{symbolfootnotes}
        \raggedright
        \newcommand{\theauthorsm}{\numexpr \theauthors - 1 \relax}
        \foreach \index in {1, ...,\theauthors}{%
          \mbox{\textbf{\getauthor{\index}{name}}%
            {\ifnum\index=\theauthors{}\else{\ifnum\index=\theauthorsm{}\else{,}\fi}\fi}}%
          \IfStrEq{\getauthor{\index}{note}}{}{}{\footnote{\getauthor{\index}{note}}}%
          \textsuperscript{\getauthor{\index}{affil}}
          \ifnum\index=\theauthorsm\textbf{and~}\fi%
        }\par%
      \end{symbolfootnotes}%

      \if\theaffils0\else
      \setlength{\leftskip}{1em}%
      \foreach \index in {1, ..., \theaffils}{
        \textsuperscript{\csuse{affil-id\index}}\csuse{affil-name\index} \par
      }
      \setlength{\leftskip}{0em}%
      \fi

      \if\csuse{author-email-switch}1
      \blfootnote{\raggedright%
        E-mail:
        \foreach \index in {1, ...,\theauthors}{%
          \href{mailto:\getauthor{\index}{email}}{\nolinkurl{\getauthor{\index}{email}}}%
          {\ifnum\index=\theauthors{}\else,\fi}
        }
      }
      \fi
    }

    \setlength{\leftskip}{1em}%
    
    % abstract
    \IfStrEq{\gAbstractSwitch}{1}{ \vspace{1em}%
      {%
        %\hangindent=1em
        %\hangafter=1
        \hspace{-1em}%
        {\textsc{Abstract:} \gAbstract}
        \par}%
    }{}
  
    % date
    \vspace{1em}
    {\hspace{-1em}%
      \IfStrEq{\gbasic}{1}{%
        \IfStrEq{\gifdraft}{1}{\gModDateLong~(draft)}{\today}%
      }{%
        \IfStrEq{\gifdraft}{1}{\textsc{Drafted}: \gModDateLong}{\textsc{Dated}: \today}%
      }
      \par%
    }%

    \IfStrEq{\gbasic}{1}{}{
    \vspace{1em}
    {%
      \hspace{-1em}%
      \textsc{Comments}:
      \iftotalpages\FPeval{\totalpagesminusone}{clip(\totalpages - 1)}$\totalpagesminusone+1$~pages,~\fi%
      \iftotalfigures\totalfigures~figures,~\fi%
      \iftotaltables\totaltables~tables,~\fi%
      \LaTeX \par}
    }

    \setlength{\leftskip}{0em}%
    
    % page-break
    \IfStrEq{\gnotitlepage}{1}{}{\IfStrEq{\gbasic}{1}{}{\newpage}}
  
    % table of contents
    \IfStrEq{\gnolistofcontents}{1}{}{
      \IfStrEq{\gbasic}{1}{}{
        \tableofcontents
      }
    }
    \flushbottom

    \vspace{1em}
  }

  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
  %%% Theorem styles %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

  \RequirePackage{mathtools}
  \RequirePackage[hyperref,thmmarks,amsmath]{ntheorem}

  % definition
  \theoremstyle{plain} \theoremheaderfont{\hspace{-.3cm}\normalfont\bfseries}
  \theorembodyfont{\upshape} \theoremsymbol{} \theoremseparator{.}  \theoremindent0.3cm
  \theorempreskip{0.5cm} \theorempostskip{0.3cm}
  \IfStrEq{\gclass}{book}{\newtheorem{definition}{Definition}[chapter]}{\newtheorem{definition}{Definition}[section]}

  % theorem
  \theoremclass{definition}
  \IfStrEq{\gclass}{book}{\newtheorem{theorem}{Theorem}[chapter]}{\newtheorem{theorem}{Theorem}[section]}

  % example
  \theoremclass{definition}
  \IfStrEq{\gclass}{book}{\newtheorem{example}{Example}[chapter]}{\newtheorem{example}{Example}[section]}

  % lemma
  \theoremclass{definition} \newtheorem{lemma}[theorem]{Lemma}

  % proposition
  \theoremclass{definition} \newtheorem{proposition}[theorem]{Proposition}

  % corollary
  \theoremclass{definition} \theoremindent0.5cm \theorempreskip{0.2cm}
  \newtheorem{corollary}{Corollary}[theorem]

  % remark
  \theoremclass{definition} \theoremstyle{nonumberplain} \theoremindent0.5cm \theorempreskip{0.2cm}
  \newtheorem{remark}{Remark}

  % remark
  \theoremclass{remark} \newtheorem{phyremark}{Physicists' Remark}

  % proof
  \theoremstyle{nonumberplain} \theoremheaderfont{\hspace{-.3cm}\sc} \theorembodyfont{\upshape}
  \theoremsymbol{$\square$} \theoremseparator{:} \theoremindent0.5cm \theorempreskip{0.2cm}
  \theorempostskip{0.3cm} \newtheorem{proof}{Proof}

  \IfStrEq{\gclass}{article}{\numberwithin{equation}{section}}{}
  \IfStrEq{\gclass}{book}{\numberwithin{equation}{chapter}}{}

  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
  %%% Comments environment %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

  \RequirePackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim

  \RequirePackage{framed} % for framed environments
  \definecolor{shadecolor}{gray}{0.9}

  \newcounter{defcounter}
  \newenvironment{comments} {%
    \IfStrEq{\gshowcomments}{0}{\expandafter\comment}{
      \begin{shaded}
        \global\chardef\dc@currentequation=\value{equation}%
        \let\c@equation\c@defcounter
        \IfStrEq{\gclass}{book}{
          \renewcommand{\theequation}{\thechapter.\%.\arabic{equation}}
        }{
          \renewcommand{\theequation}{\thesection.\%.\arabic{equation}}
        }
        % comment the following line if you don't use hyperref
        \renewcommand{\theHequation}{\theequation}%
        \textbf{Comments:}%
      }%
    } {%
      \IfStrEq{\gshowcomments}{0}{\expandafter\endcomment}{
      \end{shaded}
      \setcounter{equation}{\dc@currentequation} }%
  }

  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
  %%% Bibliography %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
  
  % \RequirePackage[natbib=true,style=numeric-comp,sorting=none]{biblatex}
  % \AtBeginBibliography{\small} \setlength\bibitemsep{0.5em}
  
  % \addbibresource{ajtex.bib} \addbibresource{\jobname.bib}
  
  % \newcommand{\makereferences}{\printbibliography[heading=bibintoc]}
  
  \RequirePackage[numbers,sort&compress]{natbib}
  \renewcommand*{\bibfont}{\small}
  \bibliographystyle{JHEP}

  \IfFileExists{\jobname.bib}{
    \newcommand*\thebibresources{\jobname}
  }{
    \newcommand*\thebibresources{ajtex}
  }
  \newcommand*\bibresources[1]{
    \renewcommand\thebibresources{#1}
  }
  
  \newcommand*\makereferences{\bibliography{\thebibresources}}
  
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
  
} % styling ends here, now except styling
{
  \newcommand{\makereferences}{
    \bibliographystyle{JHEP}
    \bibliography{ajtex,\jobname}
  }
}

%% Cleveref
\RequirePackage{cleveref}

\crefname{equation}{eq.}{eqs.}
\crefname{section}{section}{sections}
\crefname{result}{result}{results}
\crefname{appendix}{appendix}{appendices}
\crefname{figure}{figure}{figures}
\crefname{table}{table}{tables}

\newcommand\acknowledgements{\subsection*{Acknowledgements}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Custom macro %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% " macro %%%

\newcommand{\@quotemacro}{\let\@quotemacro@tl\@empty\@quotemacro@loop}
\newcommand{\@quotemacro@loop}{\futurelet\@let@token\@quotemacro@test}
\newcommand{\@quotemacro@test}
{\ifcat A\noexpand\@let@token
  \expandafter\@quotemacro@add
  \else
  \expandafter\@quotemacro@end
  \fi}
\newcommand{\@quotemacro@add}[1]{\edef\@quotemacro@tl{\@quotemacro@tl #1}\@quotemacro@loop}
\newcommand{\@quotemacro@end}{\csname quotemacro@@\@quotemacro@tl\endcsname}

\newcommand{\newquotemacro}[1]{\expandafter\newcommand\csname quotemacro@@#1\endcsname}
\begingroup
\catcode`\"=13
\global\let"=\@quotemacro
\endgroup
\mathcode`\"="8000

% counting aids
\newcommand{\countstart}{}
\newcommand{\countstop}{}

%%% fractions
\newcommand{\half}{\frac{1}{2}}
\newcommand{\third}{\frac{1}{3}}
\newcommand{\quarter}{\frac{1}{4}}

\newcommand{\sep}{\rule{\textwidth}{0.4pt}}

%% Equation Commands

\newcommand{\nn}{\nonumber}

\newcommand{\ben}{\begin{eqnarray}\displaystyle}
\newcommand{\een}{\end{eqnarray}}

\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}

\newcommand{\bea}[1]{\begin{align}#1\end{align}}
\newcommand{\bem}[1]{\begin{multline}#1\end{multline}}
\newcommand{\bee}[1]{\begin{equation}#1\end{equation}}

\newcommand*\widefbox[1]{\fbox{\hspace{2em}#1\hspace{2em}}}

\newcommand{\beebox}[1]{\begin{empheq}[box=\widefbox]{equation}#1\end{empheq}}
\newcommand{\beabox}[1]{\begin{empheq}[box=\widefbox]{align}#1\end{empheq}}


\newcommand{\dbrk}{\right. \\ \left.}
\newcommand{\tbrk}{\right. \right. \\ \left. \left.}
\newcommand{\qbrk}{\right. \right. \right. \\ \left. \left. \left.}
\newcommand{\bfrac}[2]{\lb\frac{#1}{#2}\rb}
\newcommand*{\brfrac}[2]{\genfrac{\lbrace}{\rbrace}{0pt}{}{#1}{#2}}

\newcommand{\dsp}{\displaystyle}

\newcommand{\doubt}[1]{\hl{\textbf{Doubt:} #1}}

%% Text Commands

\newcommand{\bc}{\begin{center}}
\newcommand{\ec}{\end{center}}

%% Math Symbols

\newcommand{\rmnum}[1]{\romannumeral #1}
\newcommand{\Rmnum}[1]{\expandafter\@slowromancap\romannumeral #1@}
%\newcommand{\qed}{\begin{flushright} \ensuremath{\Box} \end{flushright}}
\newcommand{\norm}[1]{|\!| #1 |\!|}
\newcommand{\BT}{\blacktriangle}

\newcommand{\grad}{{\bf \nabla}}
\newcommand{\lie}{\pounds}
\newcommand{\df}{\mathrm{d}}
\newcommand{\Df}{\mathrm{D}}
\newcommand{\dow}{\partial}
\newquotemacro{lie}{\pounds}
\newquotemacro{DD}{\mathrm{D}}
\newquotemacro{dd}{\mathrm{d}}
\newquotemacro{pd}{\partial}
\newquotemacro{dow}{\partial}

%% Symbol Shortcuts
\renewcommand{\a}{\alpha}	%%% Redefinition
\renewcommand{\b}{\beta}	%%% Redefinition
\renewcommand{\c}{\chi}		%%% Redefinition
\renewcommand{\d}{\delta}	%%% Redefinition
\newcommand{\e}{\epsilon}
\newcommand{\ve}{\varepsilon}
\newcommand{\f}{\phi}
\newcommand{\vf}{\varphi}
\newcommand{\g}{\gamma}
\newcommand{\h}{\hbar}
\newcommand{\hs}{\hslash}
\renewcommand{\i}{\iota}		%%% Redefinition
%\renewcommand{\j}{}
\renewcommand{\k}{\kappa}	%%% Redefinition
%\renewcommand{\l}{\lambda}	%%% Redefinition
\newcommand{\m}{\mu}								%%% Useless
\newcommand{\n}{\nu}								%%% Useless
\renewcommand{\o}{\omega}	%%% Redefinition
\newcommand{\p}{\psi}								%%% Useless
\newcommand{\vp}{\varpi}							%%% Useless
\newcommand{\q}{\theta}	
\newcommand{\vq}{\vartheta}	
\renewcommand{\r}{\rho}		%%% Redefinition
%\newcommand{\vr}{\varrho}	%%% Redefinition
\newcommand{\s}{\sigma}
\newcommand{\vs}{\varsigma}
\renewcommand{\t}{\tau}		%%% Redefinition
\renewcommand{\u}{\upsilon}	%%% Redefinition
%\renewcommand{\v}{}
%\newcommand{\w}{}
\newcommand{\x}{\xi}								%%% Useless
%\renewcommand{\y}{}
\newcommand{\z}{\zeta}

\newcommand{\A}{\forall}
\newcommand{\B}{\Box}
\newcommand{\C}{\mathbb{C}}
\newcommand{\D}{\Delta}
\newcommand{\E}[1]{\mathrm{e}^{#1}}
\newcommand{\F}{\Phi}
\newcommand{\G}{\Gamma}
\newcommand{\I}{\infty}
\renewcommand{\L}{\Lambda}	%%% Redefinition
\newcommand{\M}{\mho}
\newcommand{\N}{\nabla}
\renewcommand{\O}{\Omega}	%%% Redefinition
\renewcommand{\P}{\Psi}		%%% Redefinition		%%% Useless
\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\Theta}
%\renewcommand{\S}{\Sigma}
\newcommand{\U}{\Upsilon}
\newcommand{\X}{\Xi}								%%% Useless
\newcommand{\Z}{\mathcal{Z}}

%%% " small alphabets

\newquotemacro{a}{\alpha}
\newquotemacro{b}{\beta}
\newquotemacro{c}{\chi}
\newquotemacro{d}{\delta}
\newquotemacro{e}{\epsilon}  \newquotemacro{ve}{\varepsilon}
\newquotemacro{f}{\phi}  \newquotemacro{vf}{\varphi}
\newquotemacro{g}{\gamma}
\newquotemacro{h}{\eta}
\newquotemacro{i}{\iota}
\newquotemacro{j}{\varphi} % alias of "vf
\newquotemacro{k}{\kappa}
\newquotemacro{l}{\lambda}
\newquotemacro{m}{\mu}
\newquotemacro{n}{\nu}
\newquotemacro{o}{\omega}
\newquotemacro{p}{\pi}  \newquotemacro{vp}{\varpi}
\newquotemacro{q}{\theta}  \newquotemacro{vq}{\vartheta}	
\newquotemacro{r}{\rho}  \newquotemacro{vr}{\varrho}
\newquotemacro{s}{\sigma}  \newquotemacro{vs}{\varsigma}
\newquotemacro{t}{\tau}
\newquotemacro{u}{\upsilon}
%\newquotemacro{\v}{}
\newquotemacro{w}{\omega} % alias of "o
\newquotemacro{x}{\xi}
\newquotemacro{y}{\psi}
\newquotemacro{z}{\zeta}

%%% " capital alphabets

%\newquotemacro{A}{}
%\newquotemacro{B}{}
%\newquotemacro{C}{}
\newquotemacro{D}{\Delta}
%\newquotemacro{E}{\epsilon}
\newquotemacro{F}{\Phi}
\newquotemacro{G}{\Gamma}
%\newquotemacro{H}{}
%\newquotemacro{I}{}
%\newquotemacro{J}{}
%\newquotemacro{K}{}
\newquotemacro{L}{\Lambda}
%\newquotemacro{M}{}
%\newquotemacro{N}{}
\newquotemacro{O}{\Omega}
\newquotemacro{P}{\Pi}
\newquotemacro{Q}{\Theta}
%\newquotemacro{r}{}
\newquotemacro{S}{\Sigma}
%\newquotemacro{t}{}
\newquotemacro{U}{\Upsilon}
%\newquotemacro{\v}{}
\newquotemacro{W}{\Omega} % alias of "O
\newquotemacro{X}{\Xi}
\newquotemacro{Y}{\Psi}
%\newquotemacro{Z}{}

%%% Alphabet definitions %%%

\RequirePackage{xparse}

\ExplSyntaxOn

\clist_map_inline:nn{A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z}
{
  \expandafter\def\csname b#1\endcsname{\bm{#1}} % e.g. \bA -> \bm{A}
  \newquotemacro{b#1}{\bm{#1}} % e.g. "bA -> \bm{A}
  
  \expandafter\def\csname c#1\endcsname{\mathcal{#1}} % e.g. \cA -> \mathcal{A}
  \newquotemacro{c#1}{\mathcal{#1}} % e.g. "cA -> \mathcal{A}
  
  \expandafter\def\csname bc#1\endcsname{\bm{\mathcal{#1}}} % e.g. \bcA -> \bm{\mathcal{A}}
  \newquotemacro{bc#1}{\bm{\mathcal{#1}}} % e.g. "bcA -> \bm{\mathcal{A}}
  
  \expandafter\def\csname s#1\endcsname{{\mathsmaller{#1}}} % e.g. \sA -> {\mathsmaller{A}}
  \newquotemacro{s#1}{{\mathsmaller{#1}}} % e.g. "sA -> {\mathsmaller{A}}
  
  \expandafter\def\csname bb#1\endcsname{\mathbb{#1}} % e.g. \bbA -> \mathbb{A}
  \newquotemacro{bb#1}{\mathbb{#1}} % e.g. "bbA -> \mathbb{A}
  
  \expandafter\def\csname rm#1\endcsname{\mathrm{#1}} % e.g. \rmA -> \mathrm{A}
  \newquotemacro{rm#1}{\mathrm{#1}} % e.g. "rmA -> \mathrm{A}
  
  \expandafter\def\csname sc#1\endcsname{\mathscr{#1}} % e.g. \scA -> \mathscr{A}
  \newquotemacro{sc#1}{\mathscr{#1}} % e.g. "scA -> \mathscr{A}
  
  \expandafter\def\csname sf#1\endcsname{\mathsf{#1}} % e.g. \sfA -> \mathsf{A}
  \newquotemacro{sf#1}{\mathsf{#1}} % e.g. "sfA -> \mathsf{A}
  
  \expandafter\def\csname f#1\endcsname{\mathfrak{#1}} % e.g. \fA -> \mathfrak{A}
  \newquotemacro{f#1}{\mathfrak{#1}} % e.g. "fA -> \mathfrak{A}
}

\clist_map_inline:nn{a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z}
{
  \newquotemacro{b#1}{\bm{#1}} % e.g. "ba -> \bm{a}
 
  \newquotemacro{rm#1}{\mathrm{#1}} % e.g. "rma -> \mathrm{a}
  
  \newquotemacro{sc#1}{\mathscr{#1}} % e.g. "sca -> \mathscr{a}
  
  \newquotemacro{sf#1}{\mathsf{#1}} % e.g. "sfa -> \mathsf{a}
  
  \newquotemacro{f#1}{\mathfrak{#1}} % e.g. "fa -> \mathfrak{a}
}
\ExplSyntaxOff

\newcommand\ms{\mathsmaller}


\newcommand{\fa}{\mathfrak{a}}
\newcommand{\fb}{\mathfrak{b}}
\newcommand{\fc}{\mathfrak{c}}
\newcommand{\fd}{\mathfrak{d}}
\newcommand{\fe}{\mathfrak{e}}
\newcommand{\ff}{\mathfrak{f}}
\newcommand{\fg}{\mathfrak{g}}
\newcommand{\fh}{\mathfrak{h}}
\newcommand{\fii}{\mathfrak{i}}		%%% Out of Order
\newcommand{\fj}{\mathfrak{j}}
\newcommand{\fk}{\mathfrak{k}}
\newcommand{\fl}{\mathfrak{l}}
\newcommand{\fm}{\mathfrak{m}}
\newcommand{\fn}{\mathfrak{n}}
\newcommand{\fo}{\mathfrak{o}}
\newcommand{\fp}{\mathfrak{p}}
\newcommand{\fq}{\mathfrak{q}}
\newcommand{\fr}{\mathfrak{r}}
\newcommand{\fs}{\mathfrak{s}}
\newcommand{\ft}{\mathfrak{t}}
\newcommand{\fu}{\mathfrak{u}}
\newcommand{\fv}{\mathfrak{v}}
\newcommand{\fw}{\mathfrak{w}}
\newcommand{\fx}{\mathfrak{x}}
\newcommand{\fy}{\mathfrak{y}}
\newcommand{\fz}{\mathfrak{z}}

%% Standard Functions
\DeclareMathOperator{\sech}{sech}
\DeclareMathOperator{\csch}{csch}
\newcommand{\Tr}[1]{\mathrm{Tr}\lB #1\rB}
\newcommand{\Ad}[1]{\mathrm{Ad}\lB #1\rB}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\nul}{nul}
\DeclareMathOperator{\Diff}{Diff}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\SO}{SO}
\DeclareMathOperator{\SU}{SU}
\DeclareMathOperator{\diag}{diag}

%% Symbols
\newcommand{\ra}{\rightarrow}
\newcommand{\Ra}{\Rightarrow}
\newcommand{\nra}{\nrightarrow}
\newcommand{\nRa}{\nRightarrow}
\newcommand{\lB}{\left [}
\newcommand{\rB}{\right ]}
\newcommand{\lb}{\left (}
\newcommand{\rb}{\right )}
\newcommand{\lbr}{\left \{}
\newcommand{\rbr}{\right \}}
\newcommand{\<}{\left\langle}
\renewcommand{\>}{\right\rangle}		%%% Redefinition
\newcommand{\ld}{\left.}
\newcommand{\rd}{\right.}

\newcommand{\bra}[1]{\left\langle #1\right\vert}
\newcommand{\ket}[1]{\left\vert #1\right\rangle}

\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}
